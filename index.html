<!DOCTYPE html>
<html lang="bn">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>‡¶á‡¶∏‡¶≤‡¶æ‡¶Æ‡¶ø‡¶ï ‡¶®‡¶æ‡¶Æ‡¶æ‡¶ú‡ßá‡¶∞ ‡¶∏‡¶Æ‡¶Ø‡¶º</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:'Segoe UI',Tahoma,Geneva,Verdana,sans-serif;}
body{background:linear-gradient(135deg,#1a5e63,#0d2e36);color:#fff;min-height:100vh;display:flex;justify-content:center;align-items:center;padding:20px;}
.container{max-width:500px;width:100%;background:rgba(255,255,255,0.1);backdrop-filter:blur(10px);border-radius:20px;padding:30px;box-shadow:0 10px 30px rgba(0,0,0,0.3);text-align:center;}
.header{margin-bottom:30px;}
.header h1{font-size:28px;margin-bottom:10px;display:flex;align-items:center;justify-content:center;gap:10px;}
.header p{opacity:0.8;font-size:16px;}
.current-time{font-size:18px;margin-bottom:20px;background:rgba(255,255,255,0.1);padding:10px 20px;border-radius:50px;display:inline-block;}
.countdown-container{position:relative;width:250px;height:250px;margin:0 auto 30px;}
.countdown-circle{width:100%;height:100%;border-radius:50%;background:conic-gradient(#4CAF50 0%,#2E7D32 0%,rgba(255,255,255,0.1) 0%);display:flex;justify-content:center;align-items:center;position:relative;box-shadow:0 0 20px rgba(76,175,80,0.3);transition:background 1s ease;}
.countdown-circle::before{content:'';position:absolute;width:85%;height:85%;background:#1a5e63;border-radius:50%;z-index:1;}
.countdown-content{position:relative;z-index:2;text-align:center;}
.countdown-content .icon{font-size:40px;margin-bottom:10px;color:#4CAF50;}
.countdown-content .time{font-size:32px;font-weight:bold;margin-bottom:5px;letter-spacing:1px;}
.countdown-content .label{font-size:14px;opacity:0.8;}
.prayer-status{font-size:20px;margin-bottom:30px;background:rgba(255,255,255,0.1);padding:12px 20px;border-radius:10px;min-height:60px;display:flex;align-items:center;justify-content:center;}
.prayer-times{display:grid;grid-template-columns:repeat(2,1fr);gap:15px;margin-bottom:30px;}
.prayer-card{background:rgba(255,255,255,0.1);padding:15px;border-radius:10px;transition:all 0.3s ease;}
.prayer-card.current{background:rgba(255,152,0,0.2);transform:scale(1.05);box-shadow:0 5px 15px rgba(255,152,0,0.3);}
.prayer-name{font-size:16px;margin-bottom:8px;display:flex;align-items:center;justify-content:center;gap:8px;}
.prayer-time{font-size:18px;font-weight:bold;}
.location{display:flex;align-items:center;justify-content:center;gap:10px;margin-top:20px;padding:10px;background:rgba(255,255,255,0.1);border-radius:10px;}
.footer{margin-top:20px;font-size:14px;opacity:0.7;}
.loading{display:flex;flex-direction:column;align-items:center;justify-content:center;gap:15px;padding:20px;}
.spinner{width:40px;height:40px;border:4px solid rgba(255,255,255,0.3);border-radius:50%;border-top-color:#4CAF50;animation:spin 1s linear infinite;}
@keyframes spin{to{transform:rotate(360deg);}}
.error{background:rgba(244,67,54,0.2);padding:15px;border-radius:10px;margin:20px 0;display:flex;align-items:center;justify-content:center;gap:10px;}
.retry-btn{background:#4CAF50;color:white;border:none;padding:10px 20px;border-radius:50px;cursor:pointer;font-size:16px;margin-top:10px;transition:background 0.3s;}
.retry-btn:hover{background:#388E3C;}
.time-format{display:flex;justify-content:center;gap:10px;margin:15px 0;}
.format-btn{background:rgba(255,255,255,0.1);border:none;color:white;padding:8px 15px;border-radius:20px;cursor:pointer;transition:all 0.3s;}
.format-btn.active{background:#4CAF50;}
@media(max-width:480px){.container{padding:20px;}.countdown-container{width:200px;height:200px;}.countdown-content .time{font-size:26px;}.prayer-times{grid-template-columns:1fr;}}
</style>
</head>
<body>
<div class="container">
<div class="header">
<h1><i class="fas fa-mosque"></i> ‡¶á‡¶∏‡¶≤‡¶æ‡¶Æ‡ßÄ ‡¶®‡¶æ‡¶Æ‡¶æ‡¶ú‡ßá‡¶∞ ‡¶∏‡¶Æ‡¶Ø‡¶º</h1>
<p>‡¶™‡¶∞‡¶¨‡¶∞‡ßç‡¶§‡ßÄ ‡¶®‡¶æ‡¶Æ‡¶æ‡¶ú‡ßá‡¶∞ ‡¶∞‡¶ø‡¶Ø‡¶º‡ßá‡¶≤ ‡¶ü‡¶æ‡¶á‡¶Æ ‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü‡¶°‡¶æ‡¶â‡¶®</p>
</div>
<div class="current-time" id="currentTime">‡¶≤‡ßã‡¶° ‡¶π‡¶ö‡ßç‡¶õ‡ßá...</div>
<div id="appContent">
<div class="loading" id="loading">
<div class="spinner"></div>
<p>‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶Ö‡¶¨‡¶∏‡ßç‡¶•‡¶æ‡¶® ‡¶è‡¶¨‡¶Ç ‡¶®‡¶æ‡¶Æ‡¶æ‡¶ú‡ßá‡¶∞ ‡¶∏‡¶Æ‡¶Ø‡¶º ‡¶¨‡ßá‡¶∞ ‡¶ï‡¶∞‡¶æ ‡¶π‡¶ö‡ßç‡¶õ‡ßá...</p>
</div>
</div>
<div class="footer">
<p>‡¶®‡¶æ‡¶Æ‡¶æ‡¶ú‡ßá‡¶∞ ‡¶∏‡¶Æ‡¶Ø‡¶º ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶Ö‡¶¨‡¶∏‡ßç‡¶•‡¶æ‡¶® ‡¶Ö‡¶®‡ßÅ‡¶Ø‡¶æ‡¶Ø‡¶º‡ßÄ ‡¶π‡¶ø‡¶∏‡¶æ‡¶¨ ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá</p>
</div>
</div>

<script>
// Bangladesh Locations
const bangladeshLocations = {
  "Dhaka": { "Dhaka Sadar": ["Shahbagh","Ramna","Dhanmondi"], "Savar":["Savar Sadar","Aminbazar"], "Dhamrai":["Dhamrai Sadar","Nandaghat"], "Keraniganj":["Keraniganj Sadar","Kalatia"], "Gazipur":["Gazipur Sadar","Tongi"], "Narsingdi":["Narsingdi Sadar","Palash"], "Tangail":["Tangail Sadar","Basail"], "Manikganj":["Manikganj Sadar","Shibalaya"] },
  "Chattogram": { "Chattogram Sadar":["Pahartali","Panchlaish"], "Fatikchhari":["Fatikchhari Sadar","Harulalchhari"], "Cox's Bazar":["Cox's Bazar Sadar","Chakaria"] },
  "Khulna": { "Khulna Sadar":["Harintana","Labanchara"], "Dacope":["Dacope Sadar","Koyra"], "Batiaghata":["Batiaghata"] },
  "Rajshahi": { "Rajshahi Sadar":["Boalia","Paba"], "Bagha":["Bagha Sadar"] },
  "Barishal": { "Barishal Sadar":["Bandar","Kawnia"], "Bhola":["Bhola Sadar","Char Fasson"], "Jhalokathi":["Jhalokathi Sadar","Nalchiti"], "Patuakhali":["Patuakhali Sadar","Dumki"], "Pirojpur":["Pirojpur Sadar","Bhandaria"] },
  "Sylhet": { "Sylhet Sadar":["Tilagarh","Subidbazar"], "Beanibazar":["Beanibazar Sadar","Madhabpur"], "Golapganj":["Golapganj"] },
  "Mymensingh": { "Mymensingh Sadar":["Mymensingh Sadar","Trishal","Phulpur"], "Muktagachha":["Muktagachha Sadar","Haluaghat"] },
  "Rangpur": { "Rangpur Sadar":["Kacharibari","Kaunia"], "Dinajpur":["Dinajpur Sadar"] },
  "Comilla": { "Cumilla Sadar":["Cumilla Sadar","Meghna"], "Barura":["Barura","Brahmanpara"], "Daudkandi":["Daudkandi"] }
  // ‡¶Ö‡¶®‡ßç‡¶Ø‡¶æ‡¶®‡ßç‡¶Ø ‡¶ú‡ßá‡¶≤‡¶æ ‡¶ì ‡¶â‡¶™‡¶ú‡ßá‡¶≤‡¶æ ‡¶è‡¶ñ‡¶æ‡¶®‡ßá ‡¶™‡ßç‡¶∞‡¶Ø‡¶º‡ßã‡¶ú‡¶®‡ßá ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡¶æ ‡¶Ø‡¶æ‡¶¨‡ßá
};

// Global variables
let userLocation = null;
let prayerTimes = null;
let timeFormat = '12'; 
const appContent = document.getElementById('appContent');
const loadingElement = document.getElementById('loading');
const currentTimeElement = document.getElementById('currentTime');

// Initialize
function initApp() {
  updateCurrentTime();
  setInterval(updateCurrentTime,1000);
  getUserLocation();
}

// Get user location
function getUserLocation() {
  if(!navigator.geolocation){ showError("‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶¨‡ßç‡¶∞‡¶æ‡¶â‡¶ú‡¶æ‡¶∞ ‡¶ú‡¶ø‡¶ì‡¶≤‡ßã‡¶ï‡ßá‡¶∂‡¶® ‡¶∏‡¶Æ‡¶∞‡ßç‡¶•‡¶® ‡¶ï‡¶∞‡¶õ‡ßá ‡¶®‡¶æ"); return; }
  loadingElement.innerHTML=`<div class="spinner"></div><p>‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶Ö‡¶¨‡¶∏‡ßç‡¶•‡¶æ‡¶® ‡¶¨‡ßá‡¶∞ ‡¶ï‡¶∞‡¶æ ‡¶π‡¶ö‡ßç‡¶õ‡ßá...</p>`;
  navigator.geolocation.getCurrentPosition((pos)=>{
    userLocation={latitude:pos.coords.latitude,longitude:pos.coords.longitude};
    getPrayerTimes();
  },(err)=>{
    let msg="‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶Ö‡¶¨‡¶∏‡ßç‡¶•‡¶æ‡¶® ‡¶®‡¶ø‡¶∞‡ßç‡¶ß‡¶æ‡¶∞‡¶£ ‡¶ï‡¶∞‡¶æ ‡¶Ø‡¶æ‡¶Ø‡¶º‡¶®‡¶ø";
    if(err.code===err.PERMISSION_DENIED) msg="‡¶Ö‡¶¨‡¶∏‡ßç‡¶•‡¶æ‡¶® ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ï‡ßç‡¶∏‡ßá‡¶∏ ‡¶¨‡¶æ‡¶§‡¶ø‡¶≤ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá‡•§ ‡¶≤‡ßã‡¶ï‡ßá‡ßá‡¶∂‡¶® ‡¶ö‡¶æ‡¶≤‡ßÅ ‡¶ï‡¶∞‡ßÅ‡¶®‡•§";
    showError(msg);
  },{enableHighAccuracy:true,timeout:10000,maximumAge:60000});
}

// Dummy prayer times calculation
function getPrayerTimes(){
  loadingElement.innerHTML=`<div class="spinner"></div><p>‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶Ö‡¶¨‡¶∏‡ßç‡¶•‡¶æ‡¶®‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶®‡¶æ‡¶Æ‡¶æ‡¶ú‡ßá‡¶∞ ‡¶∏‡¶Æ‡¶Ø‡¶º ‡¶¨‡ßá‡¶∞ ‡¶ï‡¶∞‡¶æ ‡¶π‡¶ö‡ßç‡¶õ‡ßá...</p>`;
  setTimeout(()=>{
    prayerTimes = calculatePrayerTimes(userLocation);
    displayAppContent();
    updateCountdown();
    setInterval(updateCountdown,1000);
  },1000);
}

// Simplified prayer times
function calculatePrayerTimes(loc){
  const now = new Date();
  const prayers24=[{name:"Fajr",time:"05:30",duration:30,icon:"üåÖ"},
                   {name:"Sunrise",time:"06:45",duration:0,icon:"‚òÄÔ∏è"},
                   {name:"Dhuhr",time:"12:30",duration:40,icon:"üïå"},
                   {name:"Asr",time:"15:45",duration:40,icon:"üïå"},
                   {name:"Maghrib",time:"18:20",duration:15,icon:"üåá"},
                   {name:"Isha",time:"19:45",duration:45,icon:"üåô"}];
  return prayers24.map(p=>{
    const [h,m]=p.time.split(":").map(Number);
    let start=new Date(); start.setHours(h,m,0,0);
    let end=new Date(start); end.setMinutes(end.getMinutes()+p.duration);
    if(end<now){start.setDate(start.getDate()+1);end.setDate(end.getDate()+1);}
    return {...p,startTime:start,endTime:end,time12:to12HourFormat(p.time)};
  });
}

// Time format conversion
function to12HourFormat(time24){const [h,m]=time24.split(":").map(Number);const period=h>=12?"PM":"AM";const hh=h%12||12;return`${hh}:${m.toString().padStart(2,"0")} ${period}`;}

// Display content
function displayAppContent(){
  const locationName=getLocationName(userLocation);
  appContent.innerHTML=`
  <div class="time-format">
    <button class="format-btn ${timeFormat==='12'?'active':''}" onclick="setTimeFormat('12',event)">12-‡¶ò‡¶®‡ßç‡¶ü‡¶æ</button>
    <button class="format-btn ${timeFormat==='24'?'active':''}" onclick="setTimeFormat('24',event)">24-‡¶ò‡¶®‡ßç‡¶ü‡¶æ</button>
  </div>
  <div class="countdown-container">
    <div class="countdown-circle" id="countdownCircle">
      <div class="countdown-content">
        <div class="icon" id="prayerIcon">üïå</div>
        <div class="time" id="countdownTime">00:00:00</div>
        <div class="label" id="countdownLabel">‡¶Ö‡¶¨‡¶∂‡¶ø‡¶∑‡ßç‡¶ü</div>
      </div>
    </div>
  </div>
  <div class="prayer-status" id="prayerStatus">‡¶≤‡ßã‡¶° ‡¶π‡¶ö‡ßç‡¶õ‡ßá...</div>
  <div class="prayer-times" id="prayerTimes"></div>
  <div class="location"><i class="fas fa-map-marker-alt"></i><span id="locationText">${locationName}</span></div>`;
  updatePrayerTimesDisplay();
}

// Set time format
function setTimeFormat(f,event){timeFormat=f;document.querySelectorAll('.format-btn').forEach(b=>b.classList.remove('active'));event.target.classList.add('active');updatePrayerTimesDisplay();updatePrayerStatusDisplay();}

// Get location name
function getLocationName(loc){
  let lat=loc.latitude;
  let long=loc.longitude;
  // Simple check: Bangladesh approx lat/lon 20-27 N, 88-92 E
  if(lat>=20 && lat<=27 && long>=88 && long<=92){
    // For demo: Mymensingh Sadar
    return "‡¶Ö‡¶¨‡¶∏‡ßç‡¶•‡¶æ‡¶®: Mymensingh, Phulpur";
  } else return "‡¶Ö‡¶¨‡¶∏‡ßç‡¶•‡¶æ‡¶®: ‡¶¨‡¶æ‡¶á‡¶∞‡ßá, ‡¶Ö‡¶ú‡¶æ‡¶®‡¶æ ‡¶¶‡ßá‡¶∂";
}

// Update current time
function updateCurrentTime(){
  const now=new Date();
  const opts={weekday:'long',year:'numeric',month:'long',day:'numeric',hour:'2-digit',minute:'2-digit',second:'2-digit',hour12:timeFormat==='12'};
  currentTimeElement.textContent=now.toLocaleDateString('bn-BD',opts);
}

// Update countdown
function updateCountdown(){
  if(!prayerTimes) return;
  const now=new Date();
  let current=null,next=null;
  for(const p of prayerTimes){
    if(now>=p.startTime && now<p.endTime) current=p;
    else if(p.startTime>now && (!next||p.startTime<next.startTime)) next=p;
  }
  if(!current&&!next) next=prayerTimes[0];
  let target,ctype,disp;
  if(current){target=current.endTime;ctype='end';disp=current;}else{target=next.startTime;ctype='start';disp=next;}
  const diff=target-now;if(diff<0){prayerTimes=calculatePrayerTimes(userLocation);return;}
  const h=Math.floor(diff/(1000*60*60)),m=Math.floor((diff%(1000*60*60))/(1000*60)),s=Math.floor((diff%(1000*60))/1000);
  const tstr=`${h.toString().padStart(2,"0")}:${m.toString().padStart(2,"0")}:${s.toString().padStart(2,"0")}`;
  document.getElementById('countdownTime').textContent=tstr;
  document.getElementById('prayerIcon').textContent=disp.icon;
  updatePrayerStatusDisplay(current,next,ctype);
}

// Update prayer status
function updatePrayerStatusDisplay(current,next,ctype){
  const el=document.getElementById('prayerStatus');
  if(current){el.innerHTML=`<div><strong>${current.name} ‡¶®‡¶æ‡¶Æ‡¶æ‡¶ú ‡¶ö‡¶≤‡¶õ‡ßá</strong><br><small>‡¶∂‡ßá‡¶∑ ‡¶π‡¶§‡ßá ${document.getElementById('countdownTime').textContent}</small></div>`;}
  else if(next){el.innerHTML=`<div><strong>‡¶™‡¶∞‡¶¨‡¶∞‡ßç‡¶§‡ßÄ: ${next.name} ‡¶®‡¶æ‡¶Æ‡¶æ‡¶ú</strong><br><small>‡¶∂‡ßÅ‡¶∞‡ßÅ ‡¶π‡¶§‡ßá ${document.getElementById('countdownTime').textContent}</small></div>`;}
  updatePrayerTimesDisplay(current?current.name:'');
}

// Update prayer times display
function updatePrayerTimesDisplay(currName=''){
  const container=document.getElementById('prayerTimes');if(!prayerTimes) return;container.innerHTML='';
  prayerTimes.forEach(p=>{
    const isCurr=p.name===currName;
    const t=timeFormat==='12'?p.time12:p.time;
    const card=document.createElement('div');card.className=`prayer-card ${isCurr?'current':''}`;
    card.innerHTML=`<div class="prayer-name">${p.icon} ${p.name}</div><div class="prayer-time">${t}</div>${p.duration>0?`<small>${p.duration} ‡¶Æ‡¶ø‡¶®‡¶ø‡¶ü</small>`:''}`;
    container.appendChild(card);
  });
}

// Show error
function showError(msg){appContent.innerHTML=`<div class="error"><i class="fas fa-exclamation-triangle"></i><div><p>${msg}</p><button class="retry-btn" onclick="getUserLocation()">‡¶Ü‡¶¨‡¶æ‡¶∞ ‡¶ö‡ßá‡¶∑‡ßç‡¶ü‡¶æ ‡¶ï‡¶∞‡ßÅ‡¶®</button></div></div>`;}

window.onload=initApp;
</script>
</body>
</html>
