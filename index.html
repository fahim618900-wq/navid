<!DOCTYPE html>
<html lang="bn">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>‡¶á‡¶∏‡¶≤‡¶æ‡¶Æ‡¶ø‡¶ï ‡¶®‡¶æ‡¶Æ‡¶æ‡¶ú‡ßá‡¶∞ ‡¶∏‡¶Æ‡¶Ø‡¶º</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
* {margin:0; padding:0; box-sizing:border-box; font-family:'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;}
body {background:linear-gradient(135deg,#1a5e63,#0d2e36); color:#fff; min-height:100vh; display:flex; justify-content:center; align-items:center; padding:20px;}
.container {max-width:500px; width:100%; background:rgba(255,255,255,0.1); backdrop-filter:blur(10px); border-radius:20px; padding:30px; box-shadow:0 10px 30px rgba(0,0,0,0.3); text-align:center;}
.header h1 {font-size:28px; margin-bottom:10px; display:flex; align-items:center; justify-content:center; gap:10px;}
.current-time {font-size:18px; margin-bottom:20px; background:rgba(255,255,255,0.1); padding:10px 20px; border-radius:50px; display:inline-block;}
.countdown-container {position:relative; width:250px; height:250px; margin:0 auto 30px;}
.countdown-circle {width:100%; height:100%; border-radius:50%; background:conic-gradient(#4CAF50 0%, #2E7D32 0%, rgba(255,255,255,0.1) 0%); display:flex; justify-content:center; align-items:center; position:relative; box-shadow:0 0 20px rgba(76,175,80,0.3); transition:background 1s ease;}
.countdown-circle::before {content:''; position:absolute; width:85%; height:85%; background:#1a5e63; border-radius:50%; z-index:1;}
.countdown-content {position:relative; z-index:2; text-align:center;}
.countdown-content .icon {font-size:40px; margin-bottom:10px; color:#4CAF50;}
.countdown-content .time {font-size:32px; font-weight:bold; margin-bottom:5px; letter-spacing:1px;}
.countdown-content .label {font-size:14px; opacity:0.8;}
.prayer-status {font-size:20px; margin-bottom:30px; background:rgba(255,255,255,0.1); padding:12px 20px; border-radius:10px; min-height:60px; display:flex; align-items:center; justify-content:center;}
.prayer-times {display:grid; grid-template-columns:repeat(2,1fr); gap:15px; margin-bottom:30px;}
.prayer-card {background:rgba(255,255,255,0.1); padding:15px; border-radius:10px; transition:all 0.3s ease;}
.prayer-card.current {background:rgba(255,152,0,0.2); transform:scale(1.05); box-shadow:0 5px 15px rgba(255,152,0,0.3);}
.prayer-name {font-size:16px; margin-bottom:8px; display:flex; align-items:center; justify-content:center; gap:8px;}
.prayer-time {font-size:18px; font-weight:bold;}
.location {display:flex; align-items:center; justify-content:center; gap:10px; margin-top:20px; padding:10px; background:rgba(255,255,255,0.1); border-radius:10px;}
.footer {margin-top:20px; font-size:14px; opacity:0.7;}
.loading {display:flex; flex-direction:column; align-items:center; justify-content:center; gap:15px; padding:20px;}
.spinner {width:40px; height:40px; border:4px solid rgba(255,255,255,0.3); border-radius:50%; border-top-color:#4CAF50; animation:spin 1s linear infinite;}
@keyframes spin {to{transform:rotate(360deg);}}
.error {background:rgba(244,67,54,0.2); padding:15px; border-radius:10px; margin:20px 0; display:flex; align-items:center; justify-content:center; gap:10px;}
.retry-btn {background:#4CAF50; color:white; border:none; padding:10px 20px; border-radius:50px; cursor:pointer; font-size:16px; margin-top:10px; transition:background 0.3s;}
.retry-btn:hover {background:#388E3C;}
.time-format {display:flex; justify-content:center; gap:10px; margin:15px 0;}
.format-btn {background:rgba(255,255,255,0.1); border:none; color:white; padding:8px 15px; border-radius:20px; cursor:pointer; transition:all 0.3s;}
.format-btn.active {background:#4CAF50;}
@media(max-width:480px){.container{padding:20px;}.countdown-container{width:200px;height:200px;}.countdown-content .time{font-size:26px;}.prayer-times{grid-template-columns:1fr;}}
</style>
</head>
<body>
<div class="container">
<div class="header">
<h1><i class="fas fa-mosque"></i> ‡¶®‡¶æ‡¶Æ‡¶æ‡¶ú‡ßá‡¶∞ ‡¶∏‡¶Æ‡¶Ø‡¶º</h1>
<p>‡¶™‡¶∞‡¶¨‡¶∞‡ßç‡¶§‡ßÄ ‡¶®‡¶æ‡¶Æ‡¶æ‡¶ú‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶∞‡¶ø‡¶Ø‡¶º‡ßá‡¶≤-‡¶ü‡¶æ‡¶á‡¶Æ ‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü‡¶°‡¶æ‡¶â‡¶®</p>
</div>
<div class="current-time" id="currentTime">‡¶≤‡ßã‡¶° ‡¶π‡¶ö‡ßç‡¶õ‡ßá ‡¶∏‡¶Æ‡¶Ø‡¶º...</div>
<div id="appContent">
<div class="loading" id="loading">
<div class="spinner"></div>
<p>‡¶≤‡ßã‡¶ï‡ßá‡¶∂‡¶® ‡¶ì ‡¶®‡¶æ‡¶Æ‡¶æ‡¶ú‡ßá‡¶∞ ‡¶∏‡¶Æ‡¶Ø‡¶º ‡¶®‡ßá‡¶ì‡¶Ø‡¶º‡¶æ ‡¶π‡¶ö‡ßç‡¶õ‡ßá...</p>
</div>
</div>
<div class="footer"><p>‡¶®‡¶æ‡¶Æ‡¶æ‡¶ú‡ßá‡¶∞ ‡¶∏‡¶Æ‡¶Ø‡¶º ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶≤‡ßã‡¶ï‡ßá‡¶∂‡¶®‡ßá‡¶∞ ‡¶â‡¶™‡¶∞ ‡¶≠‡¶ø‡¶§‡ßç‡¶§‡¶ø ‡¶ï‡¶∞‡ßá ‡¶π‡¶ø‡¶∏‡¶æ‡¶¨ ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá</p></div>
</div>

<script>
// ----- Global Variables -----
let userLocation = null;
let prayerTimes = null;
let timeFormat = '12';
const appContent = document.getElementById('appContent');
const loadingElement = document.getElementById('loading');
const currentTimeElement = document.getElementById('currentTime');

// ----- Bangladesh Districts & Upazilas (sample) -----
const bangladeshLocations = [
{district:"‡¶¢‡¶æ‡¶ï‡¶æ", upazila:"‡¶¢‡¶æ‡¶ï‡¶æ ‡¶∏‡¶¶‡¶∞", lat:23.8103, lon:90.4125},
{district:"‡¶¢‡¶æ‡¶ï‡¶æ", upazila:"‡¶´‡¶∞‡¶ø‡¶¶‡¶™‡ßÅ‡¶∞", lat:23.6080, lon:89.8408},
{district:"‡¶Æ‡¶Ø‡¶º‡¶Æ‡¶®‡¶∏‡¶ø‡¶Ç‡¶π", upazila:"‡¶´‡ßÅ‡¶≤‡¶™‡ßÅ‡¶∞", lat:24.7471, lon:90.4203},
{district:"‡¶ö‡¶ü‡ßç‡¶ü‡¶ó‡ßç‡¶∞‡¶æ‡¶Æ", upazila:"‡¶ö‡¶ü‡ßç‡¶ü‡¶ó‡ßç‡¶∞‡¶æ‡¶Æ ‡¶∏‡¶¶‡¶∞", lat:22.3569, lon:91.7832},
{district:"‡¶∞‡¶æ‡¶ú‡¶∂‡¶æ‡¶π‡ßÄ", upazila:"‡¶∞‡¶æ‡¶ú‡¶∂‡¶æ‡¶π‡ßÄ ‡¶∏‡¶¶‡¶∞", lat:24.3636, lon:88.6241},
{district:"‡¶ñ‡ßÅ‡¶≤‡¶®‡¶æ", upazila:"‡¶ñ‡ßÅ‡¶≤‡¶®‡¶æ ‡¶∏‡¶¶‡¶∞", lat:22.8456, lon:89.5403},
{district:"‡¶∏‡¶ø‡¶≤‡ßá‡¶ü", upazila:"‡¶∏‡¶ø‡¶≤‡ßá‡¶ü ‡¶∏‡¶¶‡¶∞", lat:24.8949, lon:91.8687},
{district:"‡¶¨‡¶∞‡¶ø‡¶∂‡¶æ‡¶≤", upazila:"‡¶¨‡¶∞‡¶ø‡¶∂‡¶æ‡¶≤ ‡¶∏‡¶¶‡¶∞", lat:22.7010, lon:90.3535},
{district:"‡¶ï‡ßÅ‡¶Æ‡¶ø‡¶≤‡ßç‡¶≤‡¶æ", upazila:"‡¶ï‡ßÅ‡¶Æ‡¶ø‡¶≤‡ßç‡¶≤‡¶æ ‡¶∏‡¶¶‡¶∞", lat:23.4600, lon:91.1809},
{district:"‡¶®‡ßã‡¶Ø‡¶º‡¶æ‡¶ñ‡¶æ‡¶≤‡ßÄ", upazila:"‡¶®‡ßã‡¶Ø‡¶º‡¶æ‡¶ñ‡¶æ‡¶≤‡ßÄ ‡¶∏‡¶¶‡¶∞", lat:22.8167, lon:91.1000}
];

// ----- Functions -----
function getLocationName(location){
    const bdLatMin=20.5, bdLatMax=26.5, bdLonMin=88.0, bdLonMax=92.0;
    if(location.latitude>=bdLatMin && location.latitude<=bdLatMax &&
       location.longitude>=bdLonMin && location.longitude<=bdLonMax){
        let nearest=bangladeshLocations[0]; let minDist=Infinity;
        bangladeshLocations.forEach(loc=>{
            const dist=Math.hypot(location.latitude-loc.lat, location.longitude-loc.lon);
            if(dist<minDist){minDist=dist; nearest=loc;}
        });
        return `${nearest.district}, ${nearest.upazila}`;
    }
    if(location.latitude>40) return "‡¶®‡¶ø‡¶â ‡¶á‡¶Ø‡¶º‡¶∞‡ßç‡¶ï, ‡¶Ø‡ßÅ‡¶ï‡ßç‡¶§‡¶∞‡¶æ‡¶∑‡ßç‡¶ü‡ßç‡¶∞";
    if(location.latitude>20) return "‡¶ï‡¶æ‡¶Ø‡¶º‡¶∞‡ßã, ‡¶Æ‡¶ø‡¶∂‡¶∞";
    if(location.latitude>0) return "‡¶ú‡¶æ‡¶ï‡¶æ‡¶∞‡ßç‡¶§‡¶æ, ‡¶á‡¶®‡ßç‡¶¶‡ßã‡¶®‡ßá‡¶∂‡¶ø‡¶Ø‡¶º‡¶æ";
    if(location.latitude>-20) return "‡¶∏‡¶æ‡¶ì ‡¶™‡¶æ‡¶ì‡¶≤‡ßã, ‡¶¨‡ßç‡¶∞‡¶æ‡¶ú‡¶ø‡¶≤";
    return "‡¶Æ‡ßá‡¶≤‡¶¨‡ßã‡¶∞‡ßç‡¶®, ‡¶Ö‡¶∏‡ßç‡¶ü‡ßç‡¶∞‡ßá‡¶≤‡¶ø‡¶Ø‡¶º‡¶æ";
}

// Update current time
function updateCurrentTime(){
    const now = new Date();
    const options = {weekday:'long', year:'numeric', month:'long', day:'numeric', hour:'2-digit', minute:'2-digit', second:'2-digit', hour12:timeFormat==='12'};
    currentTimeElement.textContent = now.toLocaleDateString('bn-BD', options);
}

// ----- App Initialization -----
function initApp(){
    updateCurrentTime();
    setInterval(updateCurrentTime,1000);
    getUserLocation();
}

// Get user's geolocation
function getUserLocation(){
    if(!navigator.geolocation){showError("‡¶¨‡ßç‡¶∞‡¶æ‡¶â‡¶ú‡¶æ‡¶∞ ‡¶≤‡ßã‡¶ï‡ßá‡¶∂‡¶® ‡¶∏‡¶Æ‡¶∞‡ßç‡¶•‡¶® ‡¶ï‡¶∞‡ßá ‡¶®‡¶æ"); return;}
    loadingElement.innerHTML=`<div class="spinner"></div><p>‡¶≤‡ßã‡¶ï‡ßá‡¶∂‡¶® ‡¶®‡ßá‡¶ì‡¶Ø‡¶º‡¶æ ‡¶π‡¶ö‡ßç‡¶õ‡ßá...</p>`;
    navigator.geolocation.getCurrentPosition(
        pos=>{
            userLocation={latitude:pos.coords.latitude, longitude:pos.coords.longitude};
            getPrayerTimes();
        },
        err=>{
            showError("‡¶≤‡ßã‡¶ï‡ßá‡¶∂‡¶® ‡¶®‡ßá‡¶ì‡¶Ø‡¶º‡¶æ ‡¶Ø‡¶æ‡¶Ø‡¶º‡¶®‡¶ø");
        },
        {enableHighAccuracy:true, timeout:10000, maximumAge:60000}
    );
}

// Placeholder Prayer Times (simulate)
function getPrayerTimes(){
    loadingElement.innerHTML=`<div class="spinner"></div><p>‡¶®‡¶æ‡¶Æ‡¶æ‡¶ú‡ßá‡¶∞ ‡¶∏‡¶Æ‡¶Ø‡¶º ‡¶π‡¶ø‡¶∏‡¶æ‡¶¨ ‡¶ï‡¶∞‡¶æ ‡¶π‡¶ö‡ßç‡¶õ‡ßá...</p>`;
    setTimeout(()=>{
        const now = new Date();
        prayerTimes=[
            {name:"‡¶´‡¶ú‡¶∞", time:"05:30", duration:30, icon:"üåÖ"},
            {name:"‡¶∏‡ßÇ‡¶∞‡ßç‡¶Ø‡ßã‡¶¶‡¶Ø‡¶º", time:"06:45", duration:0, icon:"‚òÄÔ∏è"},
            {name:"‡¶Ø‡ßã‡¶π‡¶∞", time:"12:30", duration:40, icon:"üïå"},
            {name:"‡¶Ü‡¶∏‡¶∞", time:"15:45", duration:40, icon:"üïå"},
            {name:"‡¶Æ‡¶æ‡¶ó‡¶∞‡¶ø‡¶¨", time:"18:20", duration:15, icon:"üåá"},
            {name:"‡¶á‡¶∂‡¶æ", time:"19:45", duration:45, icon:"üåô"}
        ];
        displayAppContent();
        updateCountdown();
        setInterval(updateCountdown,1000);
    },1500);
}

// Display main app content
function displayAppContent(){
    const locationName = getLocationName(userLocation);
    appContent.innerHTML=`
    <div class="time-format">
        <button class="format-btn ${timeFormat==='12'?'active':''}" onclick="setTimeFormat('12')">12-‡¶ò‡¶£‡ßç‡¶ü‡¶æ</button>
        <button class="format-btn ${timeFormat==='24'?'active':''}" onclick="setTimeFormat('24')">24-‡¶ò‡¶£‡ßç‡¶ü‡¶æ</button>
    </div>
    <div class="countdown-container">
        <div class="countdown-circle" id="countdownCircle">
            <div class="countdown-content">
                <div class="icon" id="prayerIcon">üïå</div>
                <div class="time" id="countdownTime">00:00:00</div>
                <div class="label" id="countdownLabel">‡¶∂‡ßÅ‡¶∞‡ßÅ ‡¶π‡¶§‡ßá ‡¶¨‡¶æ‡¶ï‡¶ø</div>
            </div>
        </div>
    </div>
    <div class="prayer-status" id="prayerStatus">‡¶≤‡ßã‡¶° ‡¶π‡¶ö‡ßç‡¶õ‡ßá ‡¶®‡¶æ‡¶Æ‡¶æ‡¶ú‡ßá‡¶∞ ‡¶Ö‡¶¨‡¶∏‡ßç‡¶•‡¶æ...</div>
    <div class="prayer-times" id="prayerTimes"></div>
    <div class="location"><i class="fas fa-map-marker-alt"></i> <span id="locationText">${locationName}</span></div>
    `;
    updatePrayerTimesDisplay();
}

// Set time format
function setTimeFormat(format){
    timeFormat=format;
    document.querySelectorAll('.format-btn').forEach(btn=>btn.classList.remove('active'));
    event.target.classList.add('active');
    updatePrayerTimesDisplay();
}

// Update countdown
function updateCountdown(){
    if(!prayerTimes) return;
    const now=new Date();
    let currentPrayer=null, nextPrayer=null;
    for(const prayer of prayerTimes){
        const [h,m]=prayer.time.split(':').map(Number);
        let start=new Date(); start.setHours(h,m,0,0);
        let end=new Date(start); if(prayer.duration>0) end.setMinutes(end.getMinutes()+prayer.duration);
        if(now>=start && now<end) currentPrayer=prayer;
        else if(now<start && (!nextPrayer || start<new Date(nextPrayer.time))) nextPrayer=prayer;
    }
    if(!currentPrayer && !nextPrayer) nextPrayer=prayerTimes[0];
    const targetTime=currentPrayer?new Date():new Date(); // simplified for demo
    document.getElementById('countdownTime').textContent="00:00:00"; // simplified
    document.getElementById('prayerIcon').textContent=currentPrayer?currentPrayer.icon:nextPrayer.icon;
    updatePrayerTimesDisplay(currentPrayer?currentPrayer.name:'');
}

// Update prayer times display
function updatePrayerTimesDisplay(currentPrayerName=''){
    const container=document.getElementById('prayerTimes');
    container.innerHTML='';
    prayerTimes.forEach(prayer=>{
        const isCurrent=prayer.name===currentPrayerName;
        const timeDisplay=timeFormat==='12'?prayer.time:prayer.time; // simplified
        const card=document.createElement('div');
        card.className=`prayer-card ${isCurrent?'current':''}`;
        card.innerHTML=`<div class="prayer-name">${prayer.icon} ${prayer.name}</div><div class="prayer-time">${timeDisplay}</div>`;
        container.appendChild(card);
    });
}

// Show error
function showError(message){
    appContent.innerHTML=`<div class="error"><i class="fas fa-exclamation-triangle"></i><div><p>${message}</p><button class="retry-btn" onclick="getUserLocation()">‡¶Ü‡¶¨‡¶æ‡¶∞ ‡¶ö‡ßá‡¶∑‡ßç‡¶ü‡¶æ ‡¶ï‡¶∞‡ßÅ‡¶®</button></div></div>`;
}

// Start app
window.onload=initApp;
</script>
</body>
</html>
