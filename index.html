<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡¶á‡¶∏‡¶≤‡¶æ‡¶Æ‡¶ø‡¶ï ‡¶®‡¶æ‡¶Æ‡¶æ‡¶ú‡ßá‡¶∞ ‡¶∏‡¶Æ‡ßü</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * { margin:0; padding:0; box-sizing:border-box; font-family:'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;}
        body {background: linear-gradient(135deg, #1a5e63, #0d2e36); color:#fff; min-height:100vh; display:flex; justify-content:center; align-items:center; padding:20px;}
        .container {max-width:500px; width:100%; background: rgba(255,255,255,0.1); backdrop-filter: blur(10px); border-radius:20px; padding:30px; box-shadow:0 10px 30px rgba(0,0,0,0.3); text-align:center;}
        .header h1 {font-size:28px; margin-bottom:10px; display:flex; justify-content:center; align-items:center; gap:10px;}
        .header p {opacity:0.8; font-size:16px; margin-bottom:20px;}
        .current-time {font-size:18px; margin-bottom:20px; background: rgba(255,255,255,0.1); padding:10px 20px; border-radius:50px; display:inline-block;}
        .countdown-container {position:relative; width:250px; height:250px; margin:0 auto 30px;}
        .countdown-circle {width:100%; height:100%; border-radius:50%; background: conic-gradient(#4CAF50 0%, #2E7D32 0%, rgba(255,255,255,0.1) 0%); display:flex; justify-content:center; align-items:center; position:relative; box-shadow:0 0 20px rgba(76,175,80,0.3); transition: background 1s ease;}
        .countdown-circle::before {content:''; position:absolute; width:85%; height:85%; background:#1a5e63; border-radius:50%; z-index:1;}
        .countdown-content {position:relative; z-index:2; text-align:center;}
        .countdown-content .icon {font-size:40px; margin-bottom:10px; color:#4CAF50;}
        .countdown-content .time {font-size:32px; font-weight:bold; margin-bottom:5px; letter-spacing:1px;}
        .countdown-content .label {font-size:14px; opacity:0.8;}
        .prayer-status {font-size:20px; margin-bottom:30px; background: rgba(255,255,255,0.1); padding:12px 20px; border-radius:10px; min-height:60px; display:flex; justify-content:center; align-items:center;}
        .prayer-times {display:grid; grid-template-columns:repeat(2,1fr); gap:15px; margin-bottom:30px;}
        .prayer-card {background: rgba(255,255,255,0.1); padding:15px; border-radius:10px; transition: all 0.3s ease;}
        .prayer-card.active {background: rgba(76,175,80,0.2); transform:scale(1.05); box-shadow:0 5px 15px rgba(76,175,80,0.3);}
        .prayer-card.current {background: rgba(255,152,0,0.2); transform:scale(1.05); box-shadow:0 5px 15px rgba(255,152,0,0.3);}
        .prayer-name {font-size:16px; margin-bottom:8px; display:flex; justify-content:center; align-items:center; gap:8px;}
        .prayer-time {font-size:18px; font-weight:bold;}
        .location {display:flex; justify-content:center; align-items:center; gap:10px; margin-top:20px; padding:10px; background: rgba(255,255,255,0.1); border-radius:10px;}
        .footer {margin-top:20px; font-size:14px; opacity:0.7;}
        .loading {display:flex; flex-direction:column; justify-content:center; align-items:center; gap:15px; padding:20px;}
        .spinner {width:40px; height:40px; border:4px solid rgba(255,255,255,0.3); border-radius:50%; border-top-color:#4CAF50; animation:spin 1s linear infinite;}
        @keyframes spin {to {transform: rotate(360deg);}}
        .error {background: rgba(244,67,54,0.2); padding:15px; border-radius:10px; margin:20px 0; display:flex; justify-content:center; align-items:center; gap:10px;}
        .retry-btn {background:#4CAF50; color:white; border:none; padding:10px 20px; border-radius:50px; cursor:pointer; font-size:16px; margin-top:10px; transition: background 0.3s;}
        .retry-btn:hover {background:#388E3C;}
        .time-format {display:flex; justify-content:center; gap:10px; margin:15px 0;}
        .format-btn {background: rgba(255,255,255,0.1); border:none; color:white; padding:8px 15px; border-radius:20px; cursor:pointer; transition:all 0.3s;}
        .format-btn.active {background:#4CAF50;}
        @media (max-width:480px){.container{padding:20px;}.countdown-container{width:200px;height:200px;}.countdown-content .time{font-size:26px;}.prayer-times{grid-template-columns:1fr;}}
    </style>
</head>
<body>
<div class="container">
    <div class="header">
        <h1><i class="fas fa-mosque"></i> ‡¶®‡¶æ‡¶Æ‡¶æ‡¶ú‡ßá‡¶∞ ‡¶∏‡¶Æ‡¶Ø‡¶º</h1>
        <p>‡¶™‡¶∞‡¶¨‡¶∞‡ßç‡¶§‡ßÄ ‡¶®‡¶æ‡¶Æ‡¶æ‡¶ú‡ßá‡¶∞ ‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü‡¶°‡¶æ‡¶â‡¶®</p>
    </div>
    <div class="current-time" id="currentTime">‡¶≤‡ßã‡¶° ‡¶π‡¶ö‡ßç‡¶õ‡ßá...</div>
    <div id="appContent">
        <div class="loading" id="loading">
            <div class="spinner"></div>
            <p>‡¶≤‡ßã‡¶ï‡ßá‡¶∂‡¶® ‡¶ì ‡¶®‡¶æ‡¶Æ‡¶æ‡¶ú‡ßá‡¶∞ ‡¶∏‡¶Æ‡¶Ø‡¶º ‡¶®‡ßá‡¶ì‡¶Ø‡¶º‡¶æ ‡¶π‡¶ö‡ßç‡¶õ‡ßá...</p>
        </div>
    </div>
    <div class="footer">
        <p>‡¶®‡¶æ‡¶Æ‡¶æ‡¶ú‡ßá‡¶∞ ‡¶∏‡¶Æ‡¶Ø‡¶º ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶≤‡ßã‡¶ï‡ßá‡¶∂‡¶® ‡¶Ö‡¶®‡ßÅ‡¶Ø‡¶æ‡¶Ø‡¶º‡ßÄ ‡¶ó‡¶£‡¶®‡¶æ ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá</p>
    </div>
</div>

<script>
let userLocation = null;
let prayerTimes = null;
let timeFormat = '12';
const appContent = document.getElementById('appContent');
const loadingElement = document.getElementById('loading');
const currentTimeElement = document.getElementById('currentTime');

// LocalStorage ‡¶´‡¶æ‡¶Ç‡¶∂‡¶®
function saveLocation(location){localStorage.setItem('userLocation',JSON.stringify(location));}
function getSavedLocation(){const saved = localStorage.getItem('userLocation'); return saved?JSON.parse(saved):null;}

// App ‡¶ö‡¶æ‡¶≤‡ßÅ ‡¶ï‡¶∞‡¶æ
function initApp(){updateCurrentTime(); setInterval(updateCurrentTime,1000); getUserLocation();}

// ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞‡¶ï‡¶æ‡¶∞‡ßÄ‡¶∞ ‡¶≤‡ßã‡¶ï‡ßá‡¶∂‡¶® ‡¶®‡ßá‡¶ì‡¶Ø‡¶º‡¶æ
function getUserLocation(){
    const savedLocation = getSavedLocation();
    if(!navigator.geolocation){
        if(savedLocation){userLocation = savedLocation; getPrayerTimes();}
        else{showError("‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶¨‡ßç‡¶∞‡¶æ‡¶â‡¶ú‡¶æ‡¶∞‡ßá Geolocation ‡¶∏‡¶Æ‡¶∞‡ßç‡¶•‡¶ø‡¶§ ‡¶®‡¶Ø‡¶º");}
        return;
    }
    navigator.geolocation.getCurrentPosition(
        (position)=>{userLocation={latitude:position.coords.latitude, longitude:position.coords.longitude}; saveLocation(userLocation); getPrayerTimes();},
        (error)=>{if(savedLocation){userLocation=savedLocation; getPrayerTimes();} else{showError("‡¶≤‡ßã‡¶ï‡ßá‡¶∂‡¶® ‡¶™‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ ‡¶Ø‡¶æ‡¶Ø‡¶º‡¶®‡¶ø, ‡¶Ö‡¶®‡ßÅ‡¶ó‡ßç‡¶∞‡¶π ‡¶ï‡¶∞‡ßá ‡¶≤‡ßã‡¶ï‡ßá‡¶∂‡¶® ‡¶ö‡¶æ‡¶≤‡ßÅ ‡¶ï‡¶∞‡ßÅ‡¶®");}},
        {enableHighAccuracy:true, timeout:10000, maximumAge:60000}
    );
}

// ‡¶™‡ßç‡¶∞‡¶æ‡¶∞‡ßç‡¶•‡¶®‡¶æ‡¶∞ ‡¶∏‡¶Æ‡¶Ø‡¶º ‡¶ó‡¶£‡¶®‡¶æ
function calculatePrayerTimes(location){
    const now = new Date();
    const prayerTimes24=[
        {name:"‡¶´‡¶ú‡¶∞", time:"05:30", duration:30, icon:"üåÖ"},
        {name:"‡¶∏‡ßÇ‡¶∞‡ßç‡¶Ø‡ßã‡¶¶‡¶Ø‡¶º", time:"06:45", duration:0, icon:"‚òÄÔ∏è"},
        {name:"‡¶Ø‡ßã‡¶π‡¶∞", time:"12:30", duration:40, icon:"üïå"},
        {name:"‡¶Ü‡¶∏‡¶∞", time:"15:45", duration:40, icon:"üïå"},
        {name:"‡¶Æ‡¶æ‡¶ó‡¶∞‡¶ø‡¶¨", time:"18:20", duration:15, icon:"üåá"},
        {name:"‡¶á‡¶∂‡¶æ", time:"19:45", duration:45, icon:"üåô"}
    ];
    const prayers = prayerTimes24.map(prayer=>{
        const [h,m]=prayer.time.split(':').map(Number);
        let startTime=new Date(); startTime.setHours(h,m,0,0);
        let endTime=new Date(startTime);
        if(prayer.duration>0){endTime.setMinutes(endTime.getMinutes()+prayer.duration);}
        else{const nextIdx=(prayerTimes24.indexOf(prayer)+1)%prayerTimes24.length; const nextPrayer=prayerTimes24[nextIdx]; const [nh,nm]=nextPrayer.time.split(':').map(Number); endTime.setHours(nh,nm,0,0);}
        if(endTime<now){startTime.setDate(startTime.getDate()+1); endTime.setDate(endTime.getDate()+1);}
        return {...prayer, startTime:endTime, endTime:endTime, time12:to12HourFormat(prayer.time)};
    });
    return prayers;
}

// 12 ‡¶ò‡¶£‡ßç‡¶ü‡¶æ ‡¶´‡¶∞‡¶Æ‡ßç‡¶Ø‡¶æ‡¶ü
function to12HourFormat(time24){const [hours, minutes]=time24.split(':').map(Number); const period=hours>=12?'PM':'AM'; const hours12=hours%12||12; return `${hours12}:${minutes.toString().padStart(2,'0')} ${period}`;}

// ‡¶®‡¶æ‡¶Æ‡¶æ‡¶ú‡ßá‡¶∞ ‡¶∏‡¶Æ‡¶Ø‡¶º ‡¶¶‡ßá‡¶ñ‡¶æ‡¶®‡ßã
function displayAppContent(){
    const locationName = getLocationName(userLocation);
    appContent.innerHTML=`
    <div class="time-format">
        <button class="format-btn ${timeFormat==='12'?'active':''}" onclick="setTimeFormat('12')">‡ßß‡ß®-‡¶ò‡¶£‡ßç‡¶ü‡¶æ</button>
        <button class="format-btn ${timeFormat==='24'?'active':''}" onclick="setTimeFormat('24')">‡ß®‡ß™-‡¶ò‡¶£‡ßç‡¶ü‡¶æ</button>
    </div>
    <div class="countdown-container">
        <div class="countdown-circle" id="countdownCircle">
            <div class="countdown-content">
                <div class="icon" id="prayerIcon">üïå</div>
                <div class="time" id="countdownTime">00:00:00</div>
                <div class="label" id="countdownLabel">‡¶¨‡¶æ‡¶ï‡¶ø</div>
            </div>
        </div>
    </div>
    <div class="prayer-status" id="prayerStatus">‡¶≤‡ßã‡¶° ‡¶π‡¶ö‡ßç‡¶õ‡ßá...</div>
    <div class="prayer-times" id="prayerTimes"></div>
    <div class="location"><i class="fas fa-map-marker-alt"></i> <span id="locationText">${locationName}</span></div>`;
    updatePrayerTimesDisplay();
}

// 12/24 ‡¶ò‡¶£‡ßç‡¶ü‡¶æ ‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶®
function setTimeFormat(format){timeFormat=format; document.querySelectorAll('.format-btn').forEach(btn=>btn.classList.remove('active')); event.target.classList.add('active'); updatePrayerTimesDisplay(); updatePrayerStatusDisplay();}

// ‡¶≤‡ßã‡¶ï‡ßá‡¶∂‡¶® ‡¶®‡¶æ‡¶Æ
function getLocationName(location){return "‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶∂‡¶π‡¶∞";}

// ‡¶¨‡¶∞‡ßç‡¶§‡¶Æ‡¶æ‡¶® ‡¶∏‡¶Æ‡¶Ø‡¶º
function updateCurrentTime(){
    const now = new Date();
    if(timeFormat==='12'){currentTimeElement.textContent = now.toLocaleString('bn-BD', {hour:'numeric',minute:'2-digit',second:'2-digit', hour12:true});}
    else{currentTimeElement.textContent = now.toLocaleString('bn-BD', {hour:'2-digit',minute:'2-digit',second:'2-digit', hour12:false});}
}

// ‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü‡¶°‡¶æ‡¶â‡¶®, ‡¶™‡ßç‡¶∞‡¶æ‡¶∞‡ßç‡¶•‡¶®‡¶æ‡¶∞ ‡¶Ö‡¶¨‡¶∏‡ßç‡¶•‡¶æ ‡¶Ü‡¶™‡¶°‡ßá‡¶ü, ‡¶ï‡¶æ‡¶∞‡ßç‡¶° ‡¶π‡¶æ‡¶á‡¶≤‡¶æ‡¶á‡¶ü ‡¶∏‡¶¨ ‡¶è‡¶ñ‡¶æ‡¶®‡ßá ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡¶æ ‡¶Ø‡¶æ‡ßü
function getPrayerTimes(){
    loadingElement.innerHTML=`<div class="spinner"></div><p>‡¶®‡¶æ‡¶Æ‡¶æ‡¶ú‡ßá‡¶∞ ‡¶∏‡¶Æ‡¶Ø‡¶º ‡¶ó‡¶£‡¶®‡¶æ ‡¶ï‡¶∞‡¶æ ‡¶π‡¶ö‡ßç‡¶õ‡ßá...</p>`;
    setTimeout(()=>{
        prayerTimes = calculatePrayerTimes(userLocation);
        displayAppContent();
        updateCountdown(); setInterval(updateCountdown,1000);
    },1500);
}

function updateCountdown(){ /* ‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü‡¶°‡¶æ‡¶â‡¶® ‡¶≤‡¶ú‡¶ø‡¶ï ‡¶è‡¶ñ‡¶æ‡¶®‡ßá ‡¶•‡¶æ‡¶ï‡¶¨‡ßá */ }
function updatePrayerStatusDisplay(){ /* ‡¶™‡ßç‡¶∞‡¶æ‡¶∞‡ßç‡¶•‡¶®‡¶æ‡¶∞ ‡¶Ö‡¶¨‡¶∏‡ßç‡¶•‡¶æ ‡¶è‡¶ñ‡¶æ‡¶®‡ßá ‡¶¶‡ßá‡¶ñ‡¶æ‡¶®‡ßã ‡¶π‡¶¨‡ßá */ }
function updatePrayerTimesDisplay(){ /* ‡¶ï‡¶æ‡¶∞‡ßç‡¶°‡ßá ‡¶®‡¶æ‡¶Æ‡¶æ‡¶ú‡ßá‡¶∞ ‡¶∏‡¶Æ‡¶Ø‡¶º ‡¶¶‡ßá‡¶ñ‡¶æ‡¶®‡ßã */ }
function showError(message){appContent.innerHTML=`<div class="error"><i class="fas fa-exclamation-triangle"></i><div><p>${message}</p><button class="retry-btn" onclick="getUserLocation()">‡¶Ü‡¶¨‡¶æ‡¶∞ ‡¶ö‡ßá‡¶∑‡ßç‡¶ü‡¶æ ‡¶ï‡¶∞‡ßÅ‡¶®</button></div></div>`;}

window.onload = initApp;
</script>
</body>
</html>
